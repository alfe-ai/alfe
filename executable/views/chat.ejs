<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Alfe: <%= gitRepoNameCLI %> | <%= aiModel %></title>
    <!-- Default upright triangle favicon -->
    <link
      id="favicon"
      rel="icon"
      type="image/svg+xml"
      href="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'><polygon points='32,4 4,60 60,60' fill='black' /></svg>"
    >
    <link rel="stylesheet" href="/CSS/chat.css">
    <!-- D3.js library for rendering git graph -->
    <script src="https://d3js.org/d3.v5.min.js"></script>
</head>
<body>
<div id="sidebar">
    <center>
        <h1>
            <a href="/" style="color: inherit; text-decoration: none;">
                <% if (environment === 'unknown') { %>
                    Alfe
                <% } else { %>
                    <span class="environment-indicator <%= environment %>"><%= environment %>:</span> Alfe
                <% } %>
            </a>
        </h1>
        <p class="breadcrumb">
            <a href="/<%= gitRepoNameCLI %>/chats" target="_blank">
                <%= gitRepoNameCLI %> Chats
            </a>
        </p>
        <p class="breadcrumb">
            <a href="<%= githubURL %>" target="_blank">
                GitHub
            </a>
        </p>
    </center>

    <button id="gitUpdatePullButton">git update/pull</button>
    <div id="gitRevisionInfo" style="margin-top: 5px; font-size: 0.9em; color: #777;"></div>

    <div id="gitAlwaysVisible"
         style="margin-top: 1em; font-size: 0.9em; color: #66FF99;">
        <p><strong>Current Revision:</strong> <%= gitRevision %></p>
        <p><strong>Commit Timestamp:</strong> <%= gitTimestamp %></p>
        <p><strong>Branch:</strong> <%= gitBranchName %></p>
        <button id="gitLogButton">git log</button>
    </div>

    <div style="margin-top: 1em;">
        <form action="/<%= gitRepoNameCLI %>/chat/<%= chatNumber %>/toggle_push_after_commit" method="POST">
            <label>
                <input type="checkbox" name="pushAfterCommit"
                       <%= chatData.pushAfterCommit ? 'checked' : '' %>
                       onchange="this.form.submit()">
                Push after commit
            </label>
        </form>
    </div>

    <div id="directory-tree">
        <%- directoryTreeHTML %>
    </div>
</div>

<div id="content">
    <h2>
        Editing
        <a href="/<%= gitRepoNameCLI %>" target="_blank">
            <%= gitRepoNameCLI %>
        </a>
        with <%= aiModel %>,
        <a href="<%= chatGPTURL %>" target="_blank">
            chat #<%= chatNumber %>
        </a>
    </h2>
    <!-- Rest of file unchanged -->
</div>
</body>
</html>
